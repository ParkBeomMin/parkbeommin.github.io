<!DOCTYPE html>
<html lang="kr">


<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    [WEB] web push, ì´ë ‡ê²Œ ì‰¬ìš´ê±°ì˜€ì–´? | BeomLog
  </title>
  <meta name="description" content="ë²”ë¯¼ì˜ ê¸°ìˆ ë¸”ë¡œê·¸ì…ë‹ˆë‹¤.">
  
  <meta name="keywords" content="
  
  ">
  
  <meta name="author" content="bmpark">

  <meta http-equiv="Cache-Control" content="no-transform"/>
  <meta http-equiv="Cache-Control" content="no-siteapp">

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="stylesheet" href="/MyPortfolio/css/main.css">
  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  

  

  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
  <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7426857657290789" crossorigin="anonymous" async></script>
<meta name="generator" content="Hexo 8.0.0"></head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/MyPortfolio/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div>
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/MyPortfolio/archives">Archives</a></li>
        
        
        <li><a href="/MyPortfolio/categories">Categories</a></li>
        
        
        <li><a href="/MyPortfolio/tags">Tags</a></li>
        
        
        <li><a href="/MyPortfolio/atom.xml" target="_blank">RSS</a></li>
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="https://avatars.githubusercontent.com/u/23355295?v=4"> <i class="fa fa-caret-down"></i></i></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/MyPortfolio/archives" class="header-toolbar-left"><i
                  class="fa fa-file-text"></i> Posts </a>
        <a href="/MyPortfolio/archives"
           class="header-toolbar-right"> 57 </a>
      </li>
      <li>
        <a href="/MyPortfolio/tags" class="header-toolbar-left"><i
                  class="fa fa-tags"></i> Tags </a>
        <a href="/MyPortfolio/tags"
           class="header-toolbar-right"> 0 </a>
      </li>
      <li>
        <a href="/MyPortfolio/categories" class="header-toolbar-left"><i
                  class="fa fa-folder-open"></i> Categories </a>
        <a href="/MyPortfolio/categories"
           class="header-toolbar-right"> 30 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/MyPortfolio/">BeomLog</a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    bmpark

    <span class="post-date float-right" title="{{moment(1690472580000).format('MMM DD, YYYY, h:mm:ss A')}}">
      <i class="fa fa-pencil-square-o"></i>
      {{moment(1690472580000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1>[WEB] web push, ì´ë ‡ê²Œ ì‰¬ìš´ê±°ì˜€ì–´?</h1>
    <img src='/images/web/banner.png'>

<blockquote>
<p>ì‚¬ìš©ìë“¤ì—ê²Œ í‘¸ì‰¬ ì•Œë¦¼ì„ ë³´ë‚´ê³  ì‹¶ì€ë°..<br>ë‚œ ì•± ê°œë°œìê°€ ì•„ë‹Œë°..<br>ì–¸ì œ ë˜ ì•± ê°œë°œ ê³µë¶€ë¥¼ í•˜ì§€..</p>
</blockquote>
<p>ì•± ê°œë°œ ì•ˆí•´ë„ í‘¸ì‰¬ ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!<br>ì›¹ í‘¸ì‰¬ë¥¼ í™œìš©í•˜ë©´ ë¸Œë¼ìš°ì €ì˜ í‘¸ì‰¬ ê¸°ëŠ¥ì„ ì…ë§›ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
<h2 id="ğŸ”‘ì›¹-í‘¸ì‰¬-êµ¬í˜„ì—-ì•ì„œ"><a href="#ğŸ”‘ì›¹-í‘¸ì‰¬-êµ¬í˜„ì—-ì•ì„œ" class="headerlink" title="ğŸ”‘ì›¹ í‘¸ì‰¬ êµ¬í˜„ì— ì•ì„œ.."></a>ğŸ”‘ì›¹ í‘¸ì‰¬ êµ¬í˜„ì— ì•ì„œ..</h2><p>ì›¹ í‘¸ì‰¬ êµ¬í˜„ì— ì•ì„œ ì‹¤ìŠµ í™˜ê²½ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.<br>ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ë¼ê³  í•˜ë”ë¼ë„ ê¸°ë³¸ì ì¸ êµ¬ì¡°ëŠ” ê°™ìœ¼ë‹ˆ ì´í•´í•˜ì‹œê¸°ì— ì–´ë µì§€ ì•Šìœ¼ì‹¤ ê²ë‹ˆë‹¤!</p>
<ul>
<li>Vue (v3.3.4)</li>
<li>Node</li>
<li>Firebase firestore</li>
</ul>
<p>( ëª¨ë°”ì¼ ê¸°ì¤€ )<br>ì›¹ í‘¸ì‰¬ëŠ” ì¹´ì¹´ì˜¤ ë¸Œë¼ìš°ì € ë° ë„¤ì´ë²„ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>ì ì ˆí•œ ì¡°ì¹˜ë¥¼ ì·¨í•´ ê¸°ë³¸ ë¸Œë¼ìš°ì €(ì‚¼ì„±, í¬ë¡¬, ì‚¬íŒŒë¦¬)ë¡œ ìœ ë„í•´ì•¼í•©ë‹ˆë‹¤.<br>IOSì˜ ê²½ìš°, 16.4ë²„ì „ ì´ìƒë¶€í„° í‘¸ì‰¬ ê¸°ëŠ¥ì´ ì§€ì›ë˜ë©° PWAë¡œ êµ¬í˜„í•˜ì—¬ ì•±ì„ ë‹¤ìš´ë¡œë“œ í›„ í‘¸ì‰¬ ê¸°ëŠ¥ì´ ì§€ì›ë©ë‹ˆë‹¤.</p>
<h2 id="ğŸ“ƒêµ¬ë…-ë¶€íƒë“œë¦½ë‹ˆë‹¤"><a href="#ğŸ“ƒêµ¬ë…-ë¶€íƒë“œë¦½ë‹ˆë‹¤" class="headerlink" title="ğŸ“ƒêµ¬ë… ë¶€íƒë“œë¦½ë‹ˆë‹¤."></a>ğŸ“ƒêµ¬ë… ë¶€íƒë“œë¦½ë‹ˆë‹¤.</h2><p>ê°‘ìê¸° êµ¬ë…ì´ìš”..?</p>
<p>ì›¹ í‘¸ì‰¬ëŠ” êµ¬ë…ì„ í•œ ì‚¬ìš©ìì—ê²Œ í† í°ê°’ì„ ì–»ì–´ì„œ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤.<br>êµ¬ë… ë²„íŠ¼ì„ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.</p>
<p>êµ¬ë… ë²„íŠ¼ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">Service Worker</a>ì™€ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/PushManager">PushManager</a>ë¥¼ ì‚¬ìš©í•´ì•¼í•©ë‹ˆë‹¤.</p>
<p>Vue í”„ë¡œì íŠ¸ì˜ <code>/public</code> í´ë”ì— <code>service-worker.js</code> íŒŒì¼ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ì›¹ í‘¸ì‰¬ ìˆ˜ì‹  ì‹œ</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;push&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> text = event.<span class="property">data</span>.<span class="title function_">text</span>();</span><br><span class="line">    event.<span class="title function_">waitUntil</span>(</span><br><span class="line">        self.<span class="property">registration</span>.<span class="title function_">showNotification</span>(<span class="string">&quot;ì›¹ í‘¸ì‰¬!&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">body</span>: text,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;https://github.io/ParkBeomMin/WebPushExample&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">    );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// í‘¸ì‰¬ ì•Œë¦¼ í´ë¦­ ì‹œ</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&quot;notificationclick&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    event.<span class="property">notification</span>.<span class="title function_">close</span>();</span><br><span class="line">    event.<span class="title function_">waitUntil</span>(clients.<span class="title function_">openWindow</span>(event.<span class="property">notification</span>.<span class="property">data</span>.<span class="property">url</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>pushì™€ notificationclick ì´ë²¤íŠ¸ë¥¼ ë“±ë¡ì‹œì¼œì¤ë‹ˆë‹¤.<br>event.data.text()ë¥¼ í†µí•´ í‘¸ì‰¬ ì•Œë¦¼ì— ë³´ì—¬ì¤„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  showNotificationì˜ bodyê°’ì— ë¿Œë ¤ì¤ë‹ˆë‹¤.<br>showNotificationì˜ ì²«ë²ˆì§¸ ì¸ìëŠ” í‘¸ì‰¬ì•Œë¦¼ì˜ íƒ€ì´í‹€ë‹ˆë‹ˆë‹¤.<br>url ë¶€ë¶„ì€ notificationclick ì´ë²¤íŠ¸ì—ì„œ í‘¸ì‰¬ í´ë¦­ ì‹œ ì´ë™í•  url ê²½ë¡œì…ë‹ˆë‹¤.</p>
<p>ì´ì œ <code>HomeView.vue</code> íŒŒì¼ë¡œ ì´ë™í•˜ì—¬ êµ¬ë… ë²„íŠ¼ê³¼ service worker íŒŒì¼ì„ ë“±ë¡í•˜ê³  êµ¬ë…ì„ í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;requestPermission&quot;</span>&gt;</span>&#123;&#123; buttonText &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>ë²„íŠ¼ì€ ìœ„ì™€ ê°™ì´ ë§Œë“¤ê³ , buttonTextëŠ” êµ¬ë…ê³¼ êµ¬ë…í•´ì§€ë¥¼ ìœ„í•´ ë³€í™”ë  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buttonText = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// Service Worker ë“±ë¡ ì½”ë“œ</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;serviceWorker&#x27;</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">        <span class="keyword">const</span> workerFile = <span class="string">&#x27;/service-worker.js&#x27;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> registration = <span class="keyword">await</span> navigator.<span class="property">serviceWorker</span>.<span class="title function_">register</span>(workerFile);</span><br><span class="line">            <span class="keyword">if</span> (registration) &#123;</span><br><span class="line">                <span class="keyword">const</span> subscription = <span class="keyword">await</span> registration.<span class="property">pushManager</span>.<span class="title function_">getSubscription</span>();</span><br><span class="line">                <span class="keyword">if</span> (subscription) &#123;</span><br><span class="line">                    buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë… í•´ì§€í•˜ê¸°&#x27;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë…í•˜ê¸°&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(e.<span class="property">message</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Service Worker in navigator error&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>ì´ì œ service workerê°€ ë“±ë¡ì´ ë˜ì—ˆìœ¼ë‹ˆ, êµ¬ë… ìš”ì²­ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">requestPermission</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> registration = <span class="keyword">await</span> navigator.<span class="property">serviceWorker</span>.<span class="property">ready</span>;</span><br><span class="line">        <span class="keyword">const</span> subscription = <span class="keyword">await</span> registration.<span class="property">pushManager</span>.<span class="title function_">getSubscription</span>();</span><br><span class="line">        <span class="keyword">if</span> (subscription) &#123;</span><br><span class="line">            <span class="comment">// ì´ë¯¸ êµ¬ë…ì´ ë˜ì–´ìˆë‹¤ë©´ í•´ì§€í•˜ê¸°</span></span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> DBì— êµ¬ë… í•´ì§€ ì •ë³´ ë³´ë‚´ê¸°</span></span><br><span class="line">            buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë…í•˜ê¸°&#x27;</span>;</span><br><span class="line">            subscription.<span class="title function_">unsubscribe</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// êµ¬ë…ì´ ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ êµ¬ë…í•˜ê¸°</span></span><br><span class="line">            <span class="keyword">const</span> subscription = <span class="keyword">await</span> registration.<span class="property">pushManager</span>.<span class="title function_">subscribe</span>(&#123;</span><br><span class="line">                <span class="attr">userVisibleOnly</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">applicationServerKey</span>: vapidKey.<span class="property">value</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> DBì— êµ¬ë… ì •ë³´ ë³´ë‚´ê¸°</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;subscription =&gt; &#x27;</span>, subscription.<span class="title function_">toJSON</span>());</span><br><span class="line">            buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë… í•´ì§€í•˜ê¸°&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e.<span class="property">message</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ìš”ì²­ì€ service workerê°€ ë“±ë¡ë˜ê³  ì¤€ë¹„ê°€ ëœ ì´í›„ pushManagerì˜ getSubscription()ë¥¼ í†µí•´ êµ¬ë…ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.<br>êµ¬ë…ì´ ë˜ì–´ìˆë‹¤ë©´ í•´ì§€, ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´ êµ¬ë…ì„ í•©ë‹ˆë‹¤.<br>ëœ¬ê¸ˆì—†ì´ <code>vapidKey.value</code> ì´ ì¹œêµ¬ê°€ ë‚˜íƒ€ë‚¬ëŠ”ë° í‘¸ì‰¬ ë°œì†¡ì„ ìœ„í•œ í‚¤ê°’ì…ë‹ˆë‹¤. ì´ í‚¤ê°’ì€ ì„œë²„ë‹¨ì—ì„œ ë§Œë“¤ì–´ì•¼í•©ë‹ˆë‹¤.</p>
<p>ì´ì œ Node í”„ë¡œì íŠ¸ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
<p><code>npm install -g web-push</code><br><code>web-push generate-vapid-keys</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">=======================================</span><br><span class="line"></span><br><span class="line">Public Key:</span><br><span class="line">BAHc42Ge9Ku-Hgup-66JXrkbsWuwDTUTnoh0Y5UyQFyS04UbP7NF02ZfOMMDf2ujLTMIfKlQ4cx4Thz8ek6hze8</span><br><span class="line"></span><br><span class="line">Private Key:</span><br><span class="line">TdolN_-xYH9ARuWRDULgaXO-EFgadIM39FhCSttwswc</span><br><span class="line"></span><br><span class="line">=======================================</span><br></pre></td></tr></table></figure>

<p>ìœ„ ëª…ë ¹ì–´ë¥¼ í†µí•´ web-pushë¥¼ ì„¤ì¹˜í•˜ê³ , vapid key ê°’ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.<br>ë°œê¸‰ë°›ì€ vapid key ê°’ ì¤‘ Public Keyë¥¼ ìœ„ì—ì„œ ì–¸ê¸‰ë˜ì—ˆë˜ <code>vapidKey.value</code>ì— ë„£ì–´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vapidKey = <span class="title function_">ref</span>(</span><br><span class="line">    <span class="string">&quot;BAHc42Ge9Ku-Hgup-66JXrkbsWuwDTUTnoh0Y5UyQFyS04UbP7NF02ZfOMMDf2ujLTMIfKlQ4cx4Thz8ek6hze8&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ì´ì œ êµ¬ë… ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì•Œë¦¼ ìš”ì²­ê³¼ êµ¬ë… ì •ë³´ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<img src='/images/web/web-push-1.png'>

<img src='/images/web/web-push-2.png'>

<p>ì´ êµ¬ë… ì •ë³´ë¥¼ ê°€ì§€ê³  ë‹¤ì‹œ Node í”„ë¡œì íŠ¸ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br><code>npm install --save web-push</code></p>
<p>ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í›„ vapidí‚¤ì™€ êµ¬ë…ì •ë³´ë¥¼ í¬í•¨í•´ í‘¸ì‰¬ ë°œì†¡ ë¡œì§ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpush = <span class="built_in">require</span>(<span class="string">&quot;web-push&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vapidKeys = &#123;</span><br><span class="line">    <span class="attr">publicKey</span>:</span><br><span class="line">        <span class="string">&quot;BAHc42Ge9Ku-Hgup-66JXrkbsWuwDTUTnoh0Y5UyQFyS04UbP7NF02ZfOMMDf2ujLTMIfKlQ4cx4Thz8ek6hze8&quot;</span>,</span><br><span class="line">    <span class="attr">privateKey</span>: <span class="string">&quot;TdolN_-xYH9ARuWRDULgaXO-EFgadIM39FhCSttwswc&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">webpush.<span class="title function_">setVapidDetails</span>(</span><br><span class="line">    <span class="string">&quot;mailto:bmpark@jinhak.com&quot;</span>,</span><br><span class="line">    vapidKeys.<span class="property">publicKey</span>,</span><br><span class="line">    vapidKeys.<span class="property">privateKey</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">webpush.<span class="title function_">sendNotification</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">endpoint</span>:</span><br><span class="line">            <span class="string">&quot;https://fcm.googleapis.com/fcm/send/cRngP9o7apw:APA91bG5_i-BS2WBUSehlWxe4Pr2PLhugyvCtIcNgFSs2RcSSth60wmC61R9SH-Iq3tFpO1tqprXcFFze4ZduL-MsSGWP9DJvm7jEbWB3nM40Ui99VFNPsnoHUx-emEceevzR6vwATMn&quot;</span>,</span><br><span class="line">        <span class="attr">keys</span>: &#123;</span><br><span class="line">            <span class="attr">auth</span>: <span class="string">&quot;BjJjTUVFQi9UCBH-VqqVAg&quot;</span>,</span><br><span class="line">            <span class="attr">p256dh</span>: <span class="string">&quot;BDDJ_YGSawW1NowpbJ1Cl0N8JiFtsSuMBjjtWCly7lBrf4wnsrJP7xlVTqBKhhaMIP3RwkCfb5oSSwDVh1fbYp4&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;ì›¹í‘¸ì‰¬ë°œì†¡!&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>ì´ì œ <code>node index.js</code>ë¡œ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì›¹ í‘¸ì‰¬ ë°œì†¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
<img src='/images/web/web-push-3.png'>

<h2 id="ğŸ’»RESTFulí•œ-WebPushë¡œ"><a href="#ğŸ’»RESTFulí•œ-WebPushë¡œ" class="headerlink" title="ğŸ’»RESTFulí•œ WebPushë¡œ!"></a>ğŸ’»RESTFulí•œ WebPushë¡œ!</h2><p>ìœ„ì—ì„œ ë‹¨ìˆœíˆ ì›¹ í‘¸ì‰¬ê°€ ë™ì‘í•˜ëŠ” ê²ƒê¹Œì§€ í–ˆìœ¼ë‹ˆ, ì´ì œ dbë„ ì—°ê²°í•˜ê³  ì„œë²„ apië¡œ ì›¹ í‘¸ì‰¬ê°€ ë°œì†¡ë  ìˆ˜ ìˆë„ë¡ í•´ë³´ê² ìŠµë‹ˆë‹¤.<br>Node í”„ë¡œì íŠ¸ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
<p><code>npm install express --save</code><br><code>npm install firebase-admin --save</code></p>
<p>firebase consoleì—ì„œ í‚¤ê°’ íŒŒì¼ë„ ë‹¤ìš´ë¡œë“œ ë°›ì•„ë†“ìŠµë‹ˆë‹¤.<br>firebase project &gt; í”„ë¡œì íŠ¸ ì„¤ì • &gt; ì„œë¹„ìŠ¤ ê³„ì • &gt; ìƒˆ ë¹„ê³µê°œ í‚¤ ìƒì„±</p>
<p>ì´ì œ ê¸°ë³¸ì ì¸ ì…‹íŒ…ì€ ì™„ë£Œê°€ ë˜ì—ˆê³ , êµ¬ì¡°ë¥¼ ì¡ê³  êµ¬í˜„ì„ í•©ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ routes</span><br><span class="line">â”‚   â”œâ”€â”€ index.<span class="property">js</span></span><br><span class="line">â”‚   â””â”€â”€ webPush.<span class="property">js</span></span><br><span class="line">â”œâ”€â”€ firebase-account-file.<span class="property">json</span></span><br><span class="line">â”œâ”€â”€ firebase.<span class="property">js</span></span><br><span class="line">â”œâ”€â”€ index.<span class="property">js</span></span><br><span class="line">â”œâ”€â”€ webPush.<span class="property">controller</span>.<span class="property">js</span></span><br><span class="line">â””â”€â”€ package.<span class="property">json</span></span><br></pre></td></tr></table></figure>

<p>ê¸°ì¡´ <code>index.js</code>ì˜ webPush ê¸°ëŠ¥ë“¤ì€ <code>webPush.controller.js</code>íŒŒì¼ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.<br>ì´ì œ ê° íŒŒì¼ì— ëŒ€í•´ íŒŒí—¤ì³ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ë¨¼ì € <code>index.js</code> íŒŒì¼ì€ ê¸°ë³¸ì ì¸ express ë¼ìš°íŒ… ì²˜ë¦¬ë¥¼ í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> index = <span class="built_in">require</span>(<span class="string">&quot;./routes/index&quot;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/&quot;</span>, index);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;WebPush Server On 3000 Port&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><code>webPush.controller.js</code>ì—ì„œëŠ” vapidkeyì™€ pushë¥¼ ë³´ë‚´ëŠ” í•¨ìˆ˜ë¥¼ exportì‹œì¼œì¤ë‹ˆë‹¤.<br>vapidKeyëŠ” ì„œë²„ì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ë¥¼ ê³ ì •ìœ¼ë¡œ í”„ë¡ íŠ¸ì™€ ê°™ê²Œ ì‚¬ìš©í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— Vapidê°’ì„ ë³´ë‚´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br>dev, production í™˜ê²½ì—ì„œ ê°ê° ë‹¬ë¼ì§€ë¯€ë¡œ cross-envë¥¼ í™œìš©í•´ configê°’ìœ¼ë¡œ ì…‹íŒ…í•˜ì—¬ ì‚¬ìš©í•´ë„ ì¢‹ìŠµë‹ˆë‹¤!</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpush = <span class="built_in">require</span>(<span class="string">&quot;web-push&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vapidKeys = &#123;</span><br><span class="line">    <span class="attr">publicKey</span>:</span><br><span class="line">        <span class="string">&quot;BAHc42Ge9Ku-Hgup-66JXrkbsWuwDTUTnoh0Y5UyQFyS04UbP7NF02ZfOMMDf2ujLTMIfKlQ4cx4Thz8ek6hze8&quot;</span>,</span><br><span class="line">    <span class="attr">privateKey</span>: <span class="string">&quot;TdolN_-xYH9ARuWRDULgaXO-EFgadIM39FhCSttwswc&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">webpush.<span class="title function_">setVapidDetails</span>(</span><br><span class="line">    <span class="string">&quot;mailto:club20608@gmail.com&quot;</span>,</span><br><span class="line">    vapidKeys.<span class="property">publicKey</span>,</span><br><span class="line">    vapidKeys.<span class="property">privateKey</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getVapidKey</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> vapidKeys.<span class="property">publicKey</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">push</span> = (<span class="params">&#123; data, tokens &#125;</span>) =&gt; &#123;</span><br><span class="line">    tokens.<span class="title function_">forEach</span>(<span class="title function_">async</span> (token) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> webpush.<span class="title function_">sendNotification</span>(token, data.<span class="property">message</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; getVapidKey, push &#125;;</span><br></pre></td></tr></table></figure>

<p><code>firebase.js</code>ì—ì„œëŠ” firebaseë¥¼ ì´ˆê¸°í™”í•˜ê³  firestore dbì™€ í†µì‹ í•˜ëŠ” ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•©ë‹ˆë‹¤.<br>í† í°ì„ dbì— ì¶”ê°€&#x2F;ì‚­ì œí•˜ê³  ê°€ì ¸ì™€ì„œ ë°œì†¡ì²˜ë¦¬ë¥¼ í•©ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">    initializeApp,</span><br><span class="line">    applicationDefault,</span><br><span class="line">    cert,</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">&quot;firebase-admin/app&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; getFirestore &#125; = <span class="built_in">require</span>(<span class="string">&quot;firebase-admin/firestore&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; push &#125; = <span class="built_in">require</span>(<span class="string">&quot;./webPush.controller&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serviceAccount = <span class="built_in">require</span>(<span class="string">&quot;./firebase-account-file.json&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">initializeApp</span>(&#123;</span><br><span class="line">    <span class="attr">credential</span>: <span class="title function_">cert</span>(serviceAccount),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> db = <span class="title function_">getFirestore</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">setToken</span> = <span class="keyword">async</span> (<span class="params">&#123; endpoint, keys &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> isExist = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">const</span> q = db.<span class="title function_">collection</span>(<span class="string">&quot;token&quot;</span>).<span class="title function_">where</span>(<span class="string">&quot;endpoint&quot;</span>, <span class="string">&quot;==&quot;</span>, endpoint);</span><br><span class="line">    <span class="keyword">const</span> querySnapshot = <span class="keyword">await</span> q.<span class="title function_">get</span>();</span><br><span class="line">    querySnapshot.<span class="title function_">forEach</span>(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (doc.<span class="property">id</span>) &#123;</span><br><span class="line">            isExist = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (!isExist) &#123;</span><br><span class="line">        <span class="keyword">const</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        db.<span class="title function_">collection</span>(<span class="string">&quot;token&quot;</span>).<span class="title function_">add</span>(&#123;</span><br><span class="line">            endpoint,</span><br><span class="line">            keys,</span><br><span class="line">            <span class="attr">regDate</span>: today,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">deleteToken</span> = <span class="keyword">async</span> (<span class="params">&#123; endpoint, keys &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> q = db.<span class="title function_">collection</span>(<span class="string">&quot;token&quot;</span>).<span class="title function_">where</span>(<span class="string">&quot;endpoint&quot;</span>, <span class="string">&quot;==&quot;</span>, endpoint); <span class="comment">// query(collection(db, &#x27;token&#x27;), where(&#x27;endpoint&#x27;, &#x27;==&#x27;, true));</span></span><br><span class="line">    <span class="keyword">const</span> querySnapshot = <span class="keyword">await</span> q.<span class="title function_">get</span>();</span><br><span class="line">    querySnapshot.<span class="title function_">forEach</span>(<span class="function">(<span class="params">doc</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (doc.<span class="property">id</span>) &#123;</span><br><span class="line">            db.<span class="title function_">doc</span>(<span class="string">`token/<span class="subst">$&#123;doc.id&#125;</span>`</span>).<span class="title function_">delete</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sendMessage</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> registrationTokens = [];</span><br><span class="line">    <span class="keyword">const</span> docs = <span class="keyword">await</span> db.<span class="title function_">collection</span>(<span class="string">&quot;token&quot;</span>).<span class="title function_">get</span>();</span><br><span class="line">    <span class="comment">// ë””ë¹„ì— ë“±ë¡ëœ í† í° ê°€ì ¸ì˜¤ê¸°</span></span><br><span class="line">    docs.<span class="title function_">forEach</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">        registrationTokens.<span class="title function_">push</span>(&#123; ...result.<span class="title function_">data</span>() &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> message = &#123;</span><br><span class="line">        <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">message</span>: <span class="string">&quot;ì›¹í‘¸ì‰¬!&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">tokens</span>: registrationTokens.<span class="title function_">filter</span>(<span class="function">(<span class="params">r</span>) =&gt;</span> r.<span class="property">endpoint</span>),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title function_">push</span>(message);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    setToken,</span><br><span class="line">    sendMessage,</span><br><span class="line">    deleteToken,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>routes/index.js</code>ì—ì„œëŠ” webPush ê²½ë¡œë¡œ ë¼ìš°íŒ… í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">router.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webPush = <span class="built_in">require</span>(<span class="string">&quot;./webPush.js&quot;</span>);</span><br><span class="line">router.<span class="title function_">use</span>(<span class="string">&quot;/webPush&quot;</span>, webPush);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code>routes/webPush.js</code>ì—ì„œ ê° apië“¤ì„ êµ¬í˜„í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; setToken, deleteToken, sendMessage &#125; = <span class="built_in">require</span>(<span class="string">&quot;../firebase&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; getVapidKey &#125; = <span class="built_in">require</span>(<span class="string">&quot;../webPush.controller&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">router.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">rtCode</span>: <span class="string">&quot;S&quot;</span>, <span class="attr">vapidKey</span>: <span class="title function_">getVapidKey</span>() &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; endpoint, keys &#125; = req.<span class="property">body</span>;</span><br><span class="line">    <span class="title function_">setToken</span>(&#123; endpoint, keys &#125;);</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">rtCode</span>: <span class="string">&quot;S&quot;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/delToken&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; endpoint &#125; = req.<span class="property">body</span>;</span><br><span class="line">    <span class="title function_">deleteToken</span>(&#123; <span class="attr">endpoint</span>: <span class="built_in">decodeURIComponent</span>(endpoint) &#125;);</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">rtCode</span>: <span class="string">&quot;S&quot;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/send&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">sendMessage</span>();</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">rtoCode</span>: <span class="string">&quot;S&quot;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<p>ì´ì œ Vue í”„ë¡œì íŠ¸ë¡œ ì´ë™í•˜ì—¬ api í˜¸ì¶œì„ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
<p><code>npm i --save axios</code></p>
<p><code>main.ts</code>ë¡œ ì´ë™í•˜ì—¬ axiosë¥¼ ê¸€ë¡œë²Œí•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë“±ë¡í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$axios</span> = axios;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(router);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ì´ì œ <code>vite.config.ts</code>ë¡œ ì´ë™í•˜ì—¬ api ì„œë²„ê°€ ì œëŒ€ë¡œ í˜¸ì¶œë  ìˆ˜ ìˆë„ë¡ server ì„¤ì •ì„ í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">server</span>: &#123;</span><br><span class="line">        <span class="attr">port</span>: <span class="number">3001</span>,</span><br><span class="line">        <span class="attr">cors</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">proxy</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">                <span class="attr">target</span>: <span class="string">&#x27;http://localhost:3000&#x27;</span>,</span><br><span class="line">                <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">rewrite</span>: <span class="function">(<span class="params">path</span>) =&gt;</span> path.<span class="title function_">replace</span>(<span class="regexp">/^\/api/</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>í˜ì´ì§€ ëœë”© ì‹œ vapidKey ê°’ì„ ë°›ì•„ì™€ì„œ ì…‹íŒ…ë  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; onMounted, getCurrentInstance, ref, nextTick &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>();</span><br><span class="line"><span class="keyword">const</span> vapidKey = <span class="title function_">ref</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ds = <span class="title function_">await</span> (instance?.<span class="property">proxy</span> <span class="keyword">as</span> any).<span class="property">$axios</span>.<span class="title function_">get</span>(<span class="string">&#x27;/api/webPush&#x27;</span>);</span><br><span class="line">  vapidKey.<span class="property">value</span> = ds.<span class="property">data</span>.<span class="property">vapidKey</span>;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>requestPermission</code> í•¨ìˆ˜ì—ì„œ TODOë¡œ ë‚¨ê²¨ë†“ì•˜ë˜ ë¶€ë¶„ì—ë„ í† í°ê°’ì´ ì…‹íŒ…ë  ìˆ˜ ìˆë„ë¡ ì¶”ê°€í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">requestPermission</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> registration = <span class="keyword">await</span> navigator.<span class="property">serviceWorker</span>.<span class="property">ready</span>;</span><br><span class="line">        <span class="keyword">const</span> subscription = <span class="keyword">await</span> registration.<span class="property">pushManager</span>.<span class="title function_">getSubscription</span>();</span><br><span class="line">        <span class="keyword">if</span> (subscription) &#123;</span><br><span class="line">            <span class="comment">// ì´ë¯¸ êµ¬ë…ì´ ë˜ì–´ìˆë‹¤ë©´ í•´ì§€í•˜ê¸°</span></span><br><span class="line">            <span class="title function_">await</span> (instance?.<span class="property">proxy</span> <span class="keyword">as</span> any).<span class="property">$axios</span>.<span class="title function_">post</span>(<span class="string">`/api/webPush/delToken`</span>, subscription);</span><br><span class="line">            buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë…í•˜ê¸°&#x27;</span>;</span><br><span class="line">            subscription.<span class="title function_">unsubscribe</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// êµ¬ë…ì´ ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´ êµ¬ë…í•˜ê¸°</span></span><br><span class="line">            <span class="keyword">const</span> subscription = <span class="keyword">await</span> registration.<span class="property">pushManager</span>.<span class="title function_">subscribe</span>(&#123;</span><br><span class="line">                <span class="attr">userVisibleOnly</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">applicationServerKey</span>: vapidKey.<span class="property">value</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;subscription =&gt; &#x27;</span>, subscription.<span class="title function_">toJSON</span>());</span><br><span class="line">            <span class="title function_">await</span> (instance?.<span class="property">proxy</span> <span class="keyword">as</span> any).<span class="property">$axios</span>.<span class="title function_">post</span>(<span class="string">&#x27;/api/webPush&#x27;</span>, subscription);</span><br><span class="line">            buttonText.<span class="property">value</span> = <span class="string">&#x27;êµ¬ë… í•´ì§€í•˜ê¸°&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(e.<span class="property">message</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ì´ì œ êµ¬ë… ë²„íŠ¼ í´ë¦­ ì‹œ DBì— í† í°ì´ ì €ì¥ë˜ê³  ëª¨ë“  ì…‹íŒ…ì´ ëë‚¬ìŠµë‹ˆë‹¤.<br>postman í”„ë¡œê·¸ë¨ìœ¼ë¡œ <code>/webPush/send</code> apië¥¼ í˜¸ì¶œí•˜ë©´ ì›¹ í‘¸ì‰¬ê°€ ì •ìƒì ìœ¼ë¡œ ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
<img src='/images/web/web-push-4.png'>

<h2 id="ğŸ˜®-IOSëŠ”ìš”"><a href="#ğŸ˜®-IOSëŠ”ìš”" class="headerlink" title="ğŸ˜® IOSëŠ”ìš”??"></a>ğŸ˜® IOSëŠ”ìš”??</h2><p>IOSëŠ” ì²˜ìŒì— ë§ì”€ë“œë¦° ê²ƒê³¼ ê°™ì´ ì‚¬íŒŒë¦¬ 16.4 ë²„ì „ ì´ìƒì—ì„œ ë™ì‘ì´ ê°€ëŠ¥í•˜ë©° PWAë¡œ ë§Œë“¤ì–´ì•¼í•©ë‹ˆë‹¤.<br>PWAë¡œ ë§Œë“œëŠ” ê²ƒì€ ê¸°ì¡´ ì›¹ì‚¬ì´íŠ¸ì— Manifestë§Œ ë“±ë¡í•´ì£¼ë©´ ë©ë‹ˆë‹¤!</p>
<p>Vue í”„ë¡œì íŠ¸ë¡œ ì´ë™í•˜ì—¬ <code>public/manifest.json</code> íŒŒì¼ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.<br>icon íŒŒì¼ë“¤ì€ <a target="_blank" rel="noopener" href="https://www.favicon-generator.org/">favicon-generator</a>ì‚¬ì´íŠ¸ì—ì„œ ë§Œë“¤ì–´ì£¼ë©´ í¸ë¦¬í•©ë‹ˆë‹¤.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;short_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ì›¹í‘¸ì‰¬&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ì›¹í‘¸ì‰¬&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;start_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpush&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;display&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standalone&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;theme_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#ffc107&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;backgroun_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#ffc107&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icons&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-36x36.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;36x36&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.75&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-48x48.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;48x48&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-72x72.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;72x72&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.5&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-96x96.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;96x96&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-144x144.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;144x144&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/android-icon-192x192.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;192x192&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;density&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ê·¸ë¦¬ê³  <code>index.html</code>ë¡œ ê°€ì„œ headíƒœê·¸ ì•ˆì— mainfestíŒŒì¼ì„ ë“±ë¡í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;manifest&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/manifest.json&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/favicon.ico&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vite App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/src/main.ts&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ì´ì œ ì‹¤í–‰ì„ ì‹œì¼œë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì•±ì„ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>IOS í™˜ê²½ì—ì„œëŠ” â€˜í™ˆí™”ë©´ì— ì¶”ê°€â€™ë¥¼ í†µí•´ ì•±ì´ ì„¤ì¹˜ê°€ ë˜ê³ , êµ¬ë…ë²„íŠ¼ì„ ëˆŒëŸ¬ ì›¹ í‘¸ì‰¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<img src='/images/web/web-push-5.png'>

<hr>
<p>ëª¨ë“  ì†ŒìŠ¤ì½”ë“œëŠ” <a target="_blank" rel="noopener" href="https://github.com/ParkBeomMin/WebPushExample">WebPushExample</a>ì™€ <a target="_blank" rel="noopener" href="https://github.com/ParkBeomMin/WebPushServerExample">WebPushServerExample</a>ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

  </article>
</div>


    




</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <a href="https://parkbeommin.github.io/MyPortfolio" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>Â© 2025 bmpark</li>
      <li><a href="https://parkbeommin.github.io/MyPortfolio">Home</a></li>
      
      <li><a target="_blank" rel="noopener" href="https://github.com/parkbeommin">Github</a></li>
      
    </ul>
    <div class="footer-theme-info">
      Theme <a target="_blank" rel="noopener" href="//github.com/sabrinaluo/hexo-theme-replica">Replica</a>
      by <a target="_blank" rel="noopener" href="//github.com/sabrinaluo">Hiitea</a> â¤ Powered by Hexo
    </div>
  </footer>
</div>




<script src="/MyPortfolio/js/main.js"></script>

</body>
</html>
